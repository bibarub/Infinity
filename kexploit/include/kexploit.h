#pragma once

#ifdef __cplusplus
extern "C" {
#endif // __cplusplus

#include <psploadcore.h>
#include <stdint.h>

typedef struct 
{
    uintptr_t (* findProc)(const char *modname, const char *libname, unsigned int nid);
    void (* clearCaches)(void);
    SceModule2 *(* pspKernelFindModuleByName)(const char *modname);
    int (* pspKernelGetModel)(void);
} KernelContext;

typedef void (* KernelFunction)(const KernelContext *ctx);

int executeInKernelMode(KernelFunction kfunc);

#ifdef __cplusplus
}
#endif // __cplusplus
